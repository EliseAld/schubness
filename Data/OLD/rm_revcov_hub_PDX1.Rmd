---
title: "PCA obj"
output: html_document
---

```{r libs & paths}
library(Seurat)
path_hub <- "/Users/elise/Desktop/GitHub/Hubness_sc/R_scripts/hubness_def/rev_cov/hubs_PDX1.rds"
path_data <- "/Users/elise/Desktop/GitHub/Hubness_sc/data/PDX1/pdx1_raw_merged.txt"
data_out <- "/Users/elise/Desktop/GitHub/Hubness_sc/data/PDX1/revcovhub_rm/revcov_pca_readyforhubness.txt"
sdev_out <- "/Users/elise/Desktop/GitHub/Hubness_sc/data/PDX1/revcovhub_rm/revcov_pca_sdev.txt"
```

```{r rm hubs}
hubs <- readRDS(path_hub)
data <- read.table(path_data, header = T)
data <- data[,!(colnames(data) %in% hubs)]
```

```{r do PCA}
seurat <- CreateSeuratObject(data)
seurat <- NormalizeData(seurat)
seurat <- ScaleData(seurat)
data <- GetAssayData(seurat)
rm(seurat)
# PCA
pca <- prcomp(data)
data_proj <- t(pca$rotation)
# 363 PCs
write.table(data_proj, file=data_out)
write.table(pca$sdev,file=sdev_out)
```
