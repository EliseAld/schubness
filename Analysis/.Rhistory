ef_5 <- data.frame("Hubness_score" = h200_100[[4]])
ef_6 <- data.frame("Hubness_score" = h200_500[[4]])
ef_7 <- data.frame("Hubness_score" = h200_1000[[4]])
ef_8 <- data.frame("Hubness_score" = h200_5000[[4]])
ef_9 <- data.frame("Hubness_score" = h200_9047[[4]])
ea_1$k <- 5
ea_2$k <- 5
ea_3$k <- 5
ea_4$k <- 5
ea_5$k <- 5
ea_6$k <- 5
ea_7$k <- 5
ea_8$k <- 5
ea_9$k <- 5
eb_1$k <- 10
eb_2$k <- 10
eb_3$k <- 10
eb_4$k <- 10
eb_5$k <- 10
eb_6$k <- 10
eb_7$k <- 10
eb_8$k <- 10
eb_9$k <- 10
ec_1$k <- 20
ec_2$k <- 20
ec_3$k <- 20
ec_4$k <- 20
ec_5$k <- 20
ec_6$k <- 20
ec_7$k <- 20
ec_8$k <- 20
ec_9$k <- 20
ed_1$k <- 50
ed_2$k <- 50
ed_3$k <- 50
ed_4$k <- 50
ed_5$k <- 50
ed_6$k <- 50
ed_7$k <- 50
ed_8$k <- 50
ed_9$k <- 50
ee_1$k <- 100
ee_2$k <- 100
ee_3$k <- 100
ee_4$k <- 100
ee_5$k <- 100
ee_6$k <- 100
ee_7$k <- 100
ee_8$k <- 100
ee_9$k <- 100
ef_1$k <- 200
ef_2$k <- 200
ef_3$k <- 200
ef_4$k <- 200
ef_5$k <- 200
ef_6$k <- 200
ef_7$k <- 200
ef_8$k <- 200
ef_9$k <- 200
ea_1$Dimension <- "2"
ea_2$Dimension <- "5"
ea_3$Dimension <- "10"
ea_4$Dimension <- "50"
ea_5$Dimension <- "100"
ea_6$Dimension <- "500"
ea_7$Dimension <- "1000"
ea_8$Dimension <- "5000"
ea_9$Dimension <- "9047"
eb_1$Dimension <- "2"
eb_2$Dimension <- "5"
eb_3$Dimension <- "10"
eb_4$Dimension <- "50"
eb_5$Dimension <- "100"
eb_6$Dimension <- "500"
eb_7$Dimension <- "1000"
eb_8$Dimension <- "5000"
eb_9$Dimension <- "9047"
ec_1$Dimension <- "2"
ec_2$Dimension <- "5"
ec_3$Dimension <- "10"
ec_4$Dimension <- "50"
ec_5$Dimension <- "100"
ec_6$Dimension <- "500"
ec_7$Dimension <- "1000"
ec_8$Dimension <- "5000"
ec_9$Dimension <- "9047"
ed_1$Dimension <- "2"
ed_2$Dimension <- "5"
ed_3$Dimension <- "10"
ed_4$Dimension <- "50"
ed_5$Dimension <- "100"
ed_6$Dimension <- "500"
ed_7$Dimension <- "1000"
ed_8$Dimension <- "5000"
ed_9$Dimension <- "9047"
ee_1$Dimension <- "2"
ee_2$Dimension <- "5"
ee_3$Dimension <- "10"
ee_4$Dimension <- "50"
ee_5$Dimension <- "100"
ee_6$Dimension <- "500"
ee_7$Dimension <- "1000"
ee_8$Dimension <- "5000"
ee_9$Dimension <- "9047"
ef_1$Dimension <- "2"
ef_2$Dimension <- "5"
ef_3$Dimension <- "10"
ef_4$Dimension <- "50"
ef_5$Dimension <- "100"
ef_6$Dimension <- "500"
ef_7$Dimension <- "1000"
ef_8$Dimension <- "5000"
ef_9$Dimension <- "9047"
hubness5 <- rbind(ea_1,ea_2,ea_3,ea_4,ea_5,ea_6,ea_7,ea_8,ea_9,
eb_1,eb_2,eb_3,eb_4,eb_5,eb_6,eb_7,eb_8,eb_9,
ec_1,ec_2,ec_3,ec_4,ec_5,ec_6,ec_7,ec_8,ec_9,
ed_1,ed_2,ed_3,ed_4,ed_5,ed_6,ed_7,ed_8,ed_9,
ee_1,ee_2,ee_3,ee_4,ee_5,ee_6,ee_7,ee_8,ee_9,
ef_1,ef_2,ef_3,ef_4,ef_5,ef_6,ef_7,ef_8,ef_9)
rm(ea_1,ea_2,ea_3,ea_4,ea_5,ea_6,ea_7,ea_8,ea_9,
eb_1,eb_2,eb_3,eb_4,eb_5,eb_6,eb_7,eb_8,eb_9,
ec_1,ec_2,ec_3,ec_4,ec_5,ec_6,ec_7,ec_8,ec_9,
ed_1,ed_2,ed_3,ed_4,ed_5,ed_6,ed_7,ed_8,ed_9,
ee_1,ee_2,ee_3,ee_4,ee_5,ee_6,ee_7,ee_8,ee_9,
ef_1,ef_2,ef_3,ef_4,ef_5,ef_6,ef_7,ef_8,ef_9)
fa_1 <- data.frame("Hubness_score" = h5_2[[4]])
fa_2 <- data.frame("Hubness_score" = h5_5[[4]])
fa_3 <- data.frame("Hubness_score" = h5_10[[4]])
fa_4 <- data.frame("Hubness_score" = h5_50[[4]])
fa_5 <- data.frame("Hubness_score" = h5_100[[4]])
fa_6 <- data.frame("Hubness_score" = h5_500[[4]])
fa_7 <- data.frame("Hubness_score" = h5_1000[[4]])
fa_8 <- data.frame("Hubness_score" = h5_5000[[4]])
fa_9 <- data.frame("Hubness_score" = h5_9047[[4]])
fb_1 <- data.frame("Hubness_score" = h10_2[[4]])
fb_2 <- data.frame("Hubness_score" = h10_5[[4]])
fb_3 <- data.frame("Hubness_score" = h10_10[[4]])
fb_4 <- data.frame("Hubness_score" = h10_50[[4]])
fb_5 <- data.frame("Hubness_score" = h10_100[[4]])
fb_6 <- data.frame("Hubness_score" = h10_500[[4]])
fb_7 <- data.frame("Hubness_score" = h10_1000[[4]])
fb_8 <- data.frame("Hubness_score" = h10_5000[[4]])
fb_9 <- data.frame("Hubness_score" = h10_9047[[4]])
fc_1 <- data.frame("Hubness_score" = h20_2[[4]])
fc_2 <- data.frame("Hubness_score" = h20_5[[4]])
fc_3 <- data.frame("Hubness_score" = h20_10[[4]])
fc_4 <- data.frame("Hubness_score" = h20_50[[4]])
fc_5 <- data.frame("Hubness_score" = h20_100[[4]])
fc_6 <- data.frame("Hubness_score" = h20_500[[4]])
fc_7 <- data.frame("Hubness_score" = h20_1000[[4]])
fc_8 <- data.frame("Hubness_score" = h20_5000[[4]])
fc_9 <- data.frame("Hubness_score" = h20_9047[[4]])
fd_1 <- data.frame("Hubness_score" = h50_2[[4]])
fd_2 <- data.frame("Hubness_score" = h50_5[[4]])
fd_3 <- data.frame("Hubness_score" = h50_10[[4]])
fd_4 <- data.frame("Hubness_score" = h50_50[[4]])
fd_5 <- data.frame("Hubness_score" = h50_100[[4]])
fd_6 <- data.frame("Hubness_score" = h50_500[[4]])
fd_7 <- data.frame("Hubness_score" = h50_1000[[4]])
fd_8 <- data.frame("Hubness_score" = h50_5000[[4]])
fd_9 <- data.frame("Hubness_score" = h50_9047[[4]])
fe_1 <- data.frame("Hubness_score" = h100_2[[4]])
fe_2 <- data.frame("Hubness_score" = h100_5[[4]])
fe_3 <- data.frame("Hubness_score" = h100_10[[4]])
fe_4 <- data.frame("Hubness_score" = h100_50[[4]])
fe_5 <- data.frame("Hubness_score" = h100_100[[4]])
fe_6 <- data.frame("Hubness_score" = h100_500[[4]])
fe_7 <- data.frame("Hubness_score" = h100_1000[[4]])
fe_8 <- data.frame("Hubness_score" = h100_5000[[4]])
fe_9 <- data.frame("Hubness_score" = h100_9047[[4]])
ff_1 <- data.frame("Hubness_score" = h200_2[[4]])
ff_2 <- data.frame("Hubness_score" = h200_5[[4]])
ff_3 <- data.frame("Hubness_score" = h200_10[[4]])
ff_4 <- data.frame("Hubness_score" = h200_50[[4]])
ff_5 <- data.frame("Hubness_score" = h200_100[[4]])
ff_6 <- data.frame("Hubness_score" = h200_500[[4]])
ff_7 <- data.frame("Hubness_score" = h200_1000[[4]])
ff_8 <- data.frame("Hubness_score" = h200_5000[[4]])
ff_9 <- data.frame("Hubness_score" = h200_9047[[4]])
fa_1$k <- 5
fa_2$k <- 5
fa_3$k <- 5
fa_4$k <- 5
fa_5$k <- 5
fa_6$k <- 5
fa_7$k <- 5
fa_8$k <- 5
fa_9$k <- 5
fb_1$k <- 10
fb_2$k <- 10
fb_3$k <- 10
fb_4$k <- 10
fb_5$k <- 10
fb_6$k <- 10
fb_7$k <- 10
fb_8$k <- 10
fb_9$k <- 10
fc_1$k <- 20
fc_2$k <- 20
fc_3$k <- 20
fc_4$k <- 20
fc_5$k <- 20
fc_6$k <- 20
fc_7$k <- 20
fc_8$k <- 20
fc_9$k <- 20
fd_1$k <- 50
fd_2$k <- 50
fd_3$k <- 50
fd_4$k <- 50
fd_5$k <- 50
fd_6$k <- 50
fd_7$k <- 50
fd_8$k <- 50
fd_9$k <- 50
fe_1$k <- 100
fe_2$k <- 100
fe_3$k <- 100
fe_4$k <- 100
fe_5$k <- 100
fe_6$k <- 100
fe_7$k <- 100
fe_8$k <- 100
fe_9$k <- 100
ff_1$k <- 200
ff_2$k <- 200
ff_3$k <- 200
ff_4$k <- 200
ff_5$k <- 200
ff_6$k <- 200
ff_7$k <- 200
ff_8$k <- 200
ff_9$k <- 200
fa_1$Dimension <- "2"
fa_2$Dimension <- "5"
fa_3$Dimension <- "10"
fa_4$Dimension <- "50"
fa_5$Dimension <- "100"
fa_6$Dimension <- "500"
fa_7$Dimension <- "1000"
fa_8$Dimension <- "5000"
fa_9$Dimension <- "9047"
fb_1$Dimension <- "2"
fb_2$Dimension <- "5"
fb_3$Dimension <- "10"
fb_4$Dimension <- "50"
fb_5$Dimension <- "100"
fb_6$Dimension <- "500"
fb_7$Dimension <- "1000"
fb_8$Dimension <- "5000"
fb_9$Dimension <- "9047"
fc_1$Dimension <- "2"
fc_2$Dimension <- "5"
fc_3$Dimension <- "10"
fc_4$Dimension <- "50"
fc_5$Dimension <- "100"
fc_6$Dimension <- "500"
fc_7$Dimension <- "1000"
fc_8$Dimension <- "5000"
fc_9$Dimension <- "9047"
fd_1$Dimension <- "2"
fd_2$Dimension <- "5"
fd_3$Dimension <- "10"
fd_4$Dimension <- "50"
fd_5$Dimension <- "100"
fd_6$Dimension <- "500"
fd_7$Dimension <- "1000"
fd_8$Dimension <- "5000"
fd_9$Dimension <- "9047"
fe_1$Dimension <- "2"
fe_2$Dimension <- "5"
fe_3$Dimension <- "10"
fe_4$Dimension <- "50"
fe_5$Dimension <- "100"
fe_6$Dimension <- "500"
fe_7$Dimension <- "1000"
fe_8$Dimension <- "5000"
fe_9$Dimension <- "9047"
ff_1$Dimension <- "2"
ff_2$Dimension <- "5"
ff_3$Dimension <- "10"
ff_4$Dimension <- "50"
ff_5$Dimension <- "100"
ff_6$Dimension <- "500"
ff_7$Dimension <- "1000"
ff_8$Dimension <- "5000"
ff_9$Dimension <- "9047"
hubness6 <- rbind(fa_1,fa_2,fa_3,fa_4,fa_5,fa_6,fa_7,fa_8,fa_9,
fb_1,fb_2,fb_3,fb_4,fb_5,fb_6,fb_7,fb_8,fb_9,
fc_1,fc_2,fc_3,fc_4,fc_5,fc_6,fc_7,fc_8,fc_9,
fd_1,fd_2,fd_3,fd_4,fd_5,fd_6,fd_7,fd_8,fd_9,
fe_1,fe_2,fe_3,fe_4,fe_5,fe_6,fe_7,fe_8,fe_9,
ff_1,ff_2,ff_3,ff_4,ff_5,ff_6,ff_7,ff_8,ff_9)
rm(fa_1,fa_2,fa_3,fa_4,fa_5,fa_6,fa_7,fa_8,fa_9,
fb_1,fb_2,fb_3,fb_4,fb_5,fb_6,fb_7,fb_8,fb_9,
fc_1,fc_2,fc_3,fc_4,fc_5,fc_6,fc_7,fc_8,fc_9,
fd_1,fd_2,fd_3,fd_4,fd_5,fd_6,fd_7,fd_8,fd_9,
fe_1,fe_2,fe_3,fe_4,fe_5,fe_6,fe_7,fe_8,fe_9,
ff_1,ff_2,ff_3,ff_4,ff_5,ff_6,ff_7,ff_8,ff_9)
# Reorder factor
hubness1$Dimension <- factor(hubness1$Dimension, levels = c("2","5","10","50","100","500","1000","5000","9047"))
hubness2$Dimension <- factor(hubness2$Dimension, levels = c("2","5","10","50","100","500","1000","5000","9047"))
hubness3$Dimension <- factor(hubness3$Dimension, levels = c("2","5","10","50","100","500","1000","5000","9047"))
hubness4$Dimension <- factor(hubness4$Dimension, levels = c("2","5","10","50","100","500","1000","5000","9047"))
hubness5$Dimension <- factor(hubness5$Dimension, levels = c("2","5","10","50","100","500","1000","5000","9047"))
hubness6$Dimension <- factor(hubness6$Dimension, levels = c("2","5","10","50","100","500","1000","5000","9047"))
# Removing cells with hubness score = 0
hubness1 <- hubness1[hubness1$Hubness_score != 0,]
hubness2 <- hubness2[hubness2$Hubness_score != 0,]
hubness3 <- hubness3[hubness3$Hubness_score != 0,]
hubness4 <- hubness4[hubness4$Hubness_score != 0,]
hubness5 <- hubness5[hubness5$Hubness_score != 0,]
hubness6 <- hubness6[hubness6$Hubness_score != 0,]
# Add p val
hubness1$p <- "0.1"
hubness2$p <- "0.5"
hubness3$p <- "1"
hubness4$p <- "1.5"
hubness5$p <- "2"
hubness6$p <- "4"
# Log to zoom on differences
hubness1_log <- hubness1
hubness2_log <- hubness2
hubness3_log <- hubness3
hubness4_log <- hubness4
hubness5_log <- hubness5
hubness6_log <- hubness6
hubness1_log$Hubness_score <- log(hubness1_log$Hubness_score)
hubness2_log$Hubness_score <- log(hubness2_log$Hubness_score)
hubness3_log$Hubness_score <- log(hubness3_log$Hubness_score)
hubness4_log$Hubness_score <- log(hubness4_log$Hubness_score)
hubness5_log$Hubness_score <- log(hubness5_log$Hubness_score)
hubness6_log$Hubness_score <- log(hubness6_log$Hubness_score)
# Merge
hubness <- rbind(hubness1,hubness2,hubness3,hubness4,hubness5,hubness6)
hubness_log <- rbind(hubness1_log,hubness2_log,hubness3_log,hubness4_log,hubness5_log,hubness6_log)
get_hub1 <- function(df,kval,dim,p,ymin,ymax) { # Using the mean + 3* sd from the original paper
x_thd = c()
hub_nb = c()
for (k in kval) {
val = df$Hubness_score[df$Dimension==dim & df$p==p & df$k==k]
x_thd = c(x_thd, mean(val)+3*sd(val))
hub_nb = c(hub_nb, sum(val>=(mean(val)+sd(val))))
}
hub_val <- data.frame("k"=kval,
"x_thd"=x_thd,
"hub_nb"=hub_nb,
"ymin"=ymin,
"ymax"=ymax,
"xpos"=(max(x_thd)+max(df$Hubness_score[df$p==p]))/2,
"ypos"=ymin+0.5)
return(hub_val)
}
get_hub2 <- function(df,kval,dim,p,ymin,ymax,xpos,log=F) { # Using the method from [1] > 2k
if (log==T) {
hub_nb = c()
for (k in kval) {
val = df$Hubness_score[df$Dimension==dim & df$p==p & df$k==k]
hub_nb = c(hub_nb, sum(val>=2*log(k)))
}
x_thd = 2*log(kval)
}
else {
hub_nb = c()
for (k in kval) {
val = df$Hubness_score[df$Dimension==dim & df$p==p & df$k==k]
hub_nb = c(hub_nb, sum(val>=2*k))
}
x_thd = 2*kval
}
hub_val <- data.frame("k"=kval,
"x_thd"=x_thd,
"hub_nb"=hub_nb,
"ymin"=ymin,
"ymax"=ymax,
"xpos"=xpos,
"ypos"=ymin+0.5)
return(hub_val)
}
get_hub3 <- function(df,kval,dimval,p) { # skewness summary plot
s = c()
for (d in dimval) {
for (k in kval) {
val = df$Hubness_score[df$Dimension==d & df$p==p & df$k==k]
s = c(s, mean((val-mean(val))^3)/sd(val)^3)
}
}
skewness_val <- data.frame("k"=rep(kval,times=length(dimval)),
"skewness"=s,
"Dimension"=rep(dimval,each=length(kval)))
return(skewness_val)
}
get_hub4 <- function(df,kval,dimval,pval) { # hub 1 summary plot
x_thd = c()
hub_nb = c()
for (d in dimval) {
for (k in kval) {
for (p in pval) {
val = df$Hubness_score[df$Dimension==d & df$p==p & df$k==k]
x_thd = c(x_thd, mean(val)+3*sd(val))
hub_nb = c(hub_nb, sum(val>=(mean(val)+sd(val))))
}
}
}
hub_val <- data.frame("p"=rep(pval,times=length(dimval)*length(kval)),
"k"=rep(rep(kval,each=length(pval)),times=length(dimval)),
"Dimension"=rep(dimval,each=length(kval)*length(pval)),
"Hub_nb"=hub_nb,
"Threshold"=x_thd)
return(hub_val)
}
get_hub5 <- function(df,kval,dimval,pval,log=F) { # hub 2 summary plot
if (log==T) {
hub_nb = c()
for (d in dimval) {
for (k in kval) {
for (p in pval) {
val = df$Hubness_score[df$Dimension==d & df$p==p & df$k==k]
hub_nb = c(hub_nb, sum(val>=2*log(k)))
}
}
}
}
else {
hub_nb = c()
for (d in dimval) {
for (k in kval) {
for (p in pval) {
val = df$Hubness_score[df$Dimension==d & df$p==p & df$k==k]
hub_nb = c(hub_nb, sum(val>=2*k))
}
}
}
}
hub_val <- data.frame("p"=rep(pval,times=length(dimval)*length(kval)),
"k"=rep(rep(kval,each=length(pval)),times=length(dimval)),
"Dimension"=rep(dimval,each=length(kval)*length(pval)),
"Hub_nb"=hub_nb)
return(hub_val)
}
# Merge the dfs
hub9047 <- get_hub1(hubness1, kval=c(5,10,20,50,100,200),dim="9047",p="0.1",ymin=9,ymax=10)
hub5000 <- get_hub1(hubness1, kval=c(5,10,20,50,100,200),dim="5000",p="0.1",ymin=8,ymax=9)
hub1000 <- get_hub1(hubness1, kval=c(5,10,20,50,100,200),dim="1000",p="0.1",ymin=7,ymax=8)
hub500 <- get_hub1(hubness1, kval=c(5,10,20,50,100,200),dim="500",p="0.1",ymin=6,ymax=7)
hub100 <- get_hub1(hubness1, kval=c(5,10,20,50,100,200),dim="100",p="0.1",ymin=5,ymax=6)
hub50 <- get_hub1(hubness1, kval=c(5,10,20,50,100,200),dim="50",p="0.1",ymin=4,ymax=5)
hub10 <- get_hub1(hubness1, kval=c(5,10,20,50,100,200),dim="10",p="0.1",ymin=3,ymax=4)
hub5 <- get_hub1(hubness1, kval=c(5,10,20,50,100,200),dim="5",p="0.1",ymin=2,ymax=3)
hub2 <- get_hub1(hubness1, kval=c(5,10,20,50,100,200),dim="2",p="0.1",ymin=1,ymax=2)
hub9047_log <- get_hub1(hubness1_log, kval=c(5,10,20,50,100,200),dim="9047",p="0.1",ymin=9,ymax=10)
hub5000_log <- get_hub1(hubness1_log, kval=c(5,10,20,50,100,200),dim="5000",p="0.1",ymin=8,ymax=9)
hub1000_log <- get_hub1(hubness1_log, kval=c(5,10,20,50,100,200),dim="1000",p="0.1",ymin=7,ymax=8)
hub500_log <- get_hub1(hubness1_log, kval=c(5,10,20,50,100,200),dim="500",p="0.1",ymin=6,ymax=7)
hub100_log <- get_hub1(hubness1_log, kval=c(5,10,20,50,100,200),dim="100",p="0.1",ymin=5,ymax=6)
hub50_log <- get_hub1(hubness1_log, kval=c(5,10,20,50,100,200),dim="50",p="0.1",ymin=4,ymax=5)
hub10_log <- get_hub1(hubness1_log, kval=c(5,10,20,50,100,200),dim="10",p="0.1",ymin=3,ymax=4)
hub5_log <- get_hub1(hubness1_log, kval=c(5,10,20,50,100,200),dim="5",p="0.1",ymin=2,ymax=3)
hub2_log <- get_hub1(hubness1_log, kval=c(5,10,20,50,100,200),dim="2",p="0.1",ymin=1,ymax=2)
# Viz
ggplot(hubness1, aes(x = Hubness_score, y = Dimension, fill = p)) +
scale_fill_manual(values = "royalblue2") +
geom_density_ridges() +
theme_ridges() +
xlab("Hubness score") +
ylab("Dimension of the input space") +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub9047, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub5000, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub1000, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub500, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub100, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub50, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub10, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub5, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub2, colour="violetred", inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub9047, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub5000, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub1000, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub500, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub100, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub50, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub10, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub5, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub2, inherit.aes = F) +
facet_wrap( ~ k) +
ggtitle('Hubness scores comparison of Lp norm between dimensionalities,\np=0.1')
ggplot(hubness1_log, aes(x = Hubness_score, y = Dimension, fill = p)) +
scale_fill_manual(values = "royalblue2") +
geom_density_ridges() +
theme_ridges() +
xlab("Hubness score (log)") +
ylab("Dimension of the input space") +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub9047_log, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub5000_log, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub1000_log, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub500_log, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub100_log, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub50_log, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub10_log, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub5_log, colour="violetred", inherit.aes = F) +
geom_segment(aes(x = x_thd, xend = x_thd, y = ymin, yend = ymax), hub2_log, colour="violetred", inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub9047_log, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub5000_log, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub1000_log, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub500_log, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub100_log, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub50_log, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub10_log, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub5_log, inherit.aes = F) +
geom_text(aes(x = xpos, label = hub_nb, y = ypos), hub2_log, inherit.aes = F) +
facet_wrap( ~ k) +
ggtitle('Hubness scores comparison of Lp norm between dimensionalities,\np=0.1')
