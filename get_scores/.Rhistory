GSE100866_pca_readyforhubness <- read.csv("~/Desktop/Imagine_bckp/scRNAseq/Data_sc/hubness_data/10X/GSE100866_pca_readyforhubness.csv", sep="")
View(GSE100866_pca_readyforhubness)
data <- GSE100866_pca_readyforhubness
data <- data[,1:100]
# Range of k values
k.val <- c(5,50,100,200)
# Range of p values for Lp norm
p.val <- c(0.1,0.5,1,1.5,2,4,10)
k.val=c(5,10)
p.val =c(0.1,0.5)
pc.val=2
mat <- t(data)
p=0.1
dist.matrix <- philentropy::distance(mat,method="minkowski",p)
View(dist.matrix)
dist.matrix[diag(dist.matrix)] <- NA # make the matrix upper triangular
View(dist.matrix)
diag(dist.matrix)
diag(dist.matrix) <- NA # make the matrix upper triangular
View(dist.matrix)
k.nn <- t(apply(dist.matrix,1,function(x) order(x,na.last=T)[1:k]))
k=5
k.nn <- t(apply(dist.matrix,1,function(x) order(x,na.last=T)[1:k]))
occurence <- sapply(X=1:nrow(k.nn), FUN=function(x,y) {sum(y==x)}, y=k.nn)
names(occurence) <- colnames(data)
dist.matrix[diag(dist.matrix)] <- NA # make the matrix upper triangular
k.nn <- t(apply(dist.matrix,1,function(x) order(x,na.last=T)[1:k]))
occurence <- sapply(X=1:nrow(k.nn), FUN=function(x,y) {sum(y==x)}, y=k.nn)
diag(dist.matrix) <- NA # remove diag
dist.matrix <- philentropy::distance(mat,method="minkowski",p)
diag(dist.matrix) <- NA # remove diag
k.nn <- t(apply(dist.matrix,1,function(x) order(x,na.last=T)[1:k]))
occu2<- sapply(X=1:nrow(k.nn), FUN=function(x,y) {sum(y==x)}, y=k.nn)
plot(occu2,occurence)
all(occu2=occurence)
all(occu2==occurence)
data <- GSE100866_pca_readyforhubness[,1:500]
dist.matrix <- philentropy::distance(mat,method="minkowski",p)
mat <- t(data)
dist.matrix <- philentropy::distance(mat,method="minkowski",p)
diag(dist.matrix) <- NA # remove diag
k.nn <- t(apply(dist.matrix,1,function(x) order(x,na.last=T)[1:k]))
occurence <- sapply(X=1:nrow(k.nn), FUN=function(x,y) {sum(y==x)}, y=k.nn)
dist.matrix[lower.tri(dist.matrix, diag=T)] <- NA # make the matrix upper triangular
k.nn <- t(apply(dist.matrix,1,function(x) order(x,na.last=T)[1:k]))
occurence2 <- sapply(X=1:nrow(k.nn), FUN=function(x,y) {sum(y==x)}, y=k.nn)
all(occurence==occurence2)
rm(GSE100866_pca_readyforhubness)
rm(dist.matrix)
rm(k.nn)
rm(k,k.val,occu2,occurence)
rm(occurence2)
rm(mat)
rm(p,p.val,pc.val)
