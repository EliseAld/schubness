---
title: "PCA obj"
output: html_document
---

```{r libs & paths}
library(Seurat)
path_hub <- "/Users/elise/Desktop/GitHub/Hubness_sc/R_scripts/hubness_def/rev_cov/hubs_Guo.rds"
path_data <- "/Users/elise/Desktop/TheÌ€se/scRNAseq/Data_sc/Guo_lung_2018/GSE99254_NSCLC.TCell.S9055.count.labeled.tx"
data_out <- "/Users/elise/Desktop/GitHub/Hubness_sc/data/Guo/revcovhub_rm/revcov_pca_readyforhubness.txt"
sdev_out <- "/Users/elise/Desktop/GitHub/Hubness_sc/data/Guo/revcovhub_rm/revcov_pca_sdev.txt"
```

```{r rm hubs}
hubs <- readRDS(path_hub)
data <- read.table(path_data, header = T)
data <- data[,!(colnames(data) %in% hubs)]
```

```{r do PCA}
seurat <- CreateSeuratObject(data)
seurat <- NormalizeData(seurat)
seurat <- ScaleData(seurat)
data <- GetAssayData(seurat)
rm(seurat)
# PCA
pca <- prcomp(data)
data_proj <- t(pca$rotation)
# 363 PCs
write.table(data_proj, file=data_out)
write.table(pca$sdev,file=sdev_out)
```
